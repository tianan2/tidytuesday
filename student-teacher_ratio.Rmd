---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(tidyverse)
theme_set(theme_light())
options(scipen = 999)

student_ratio <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-07/student_teacher_ratio.csv")
```

```{r}
student_teacher_ratio_2015 <- student_ratio %>% 
  filter(indicator == "Primary Education", 
         year == "2015",
         !is.na(student_ratio)) 

student_teacher_ratio_2015 %>% 
  arrange(desc(student_ratio)) %>% 
  slice(c(1:10, seq(n() - 10, n()))) %>% 
  mutate(country = fct_reorder(country, student_ratio)) %>% 
  ggplot(aes(country, student_ratio)) + 
  geom_point() +
  coord_flip() + 
  expand_limits(y = 0) +
  labs(title = "Figure. Countries with the highest and lowest student/teacher ratio",
       x = "", 
       y = "Student/teacher ratio (primary education)")
```

```{r}
library(WDI)

WDIsearch("^Population") %>% 
  as.data.frame() %>% 
  tbl_df() %>% 
  filter(str_detect(name, "total"))
```

```{r}
gdp_per_capita <- WDI(indicator = "NY.GDP.PCAP.CD", start = 2015, end = 2015, extra = TRUE) %>% 
  tbl_df() %>% 
  transmute(country_code = as.character(iso3c), 
         gdp_per_capita = NY.GDP.PCAP.CD)

population_total <- WDI(indicator = "SP.POP.TOTL", start = 2015, end = 2015, extra = TRUE) %>% 
  tbl_df() 
  transmute(country_code = as.character(iso3c), 
         gdp_per_capita = NY.GDP.PCAP.CD)
```

```{r}
student_teacher_ratio_2015 %>% 
  ggplot(aes(student_ratio)) +
  geom_histogram() +
  scale_x_log10()

student_teacher_ratio_2015 %>% 
  inner_join(gdp_per_capita, by = "country_code") %>% 
  ggplot(aes(gdp_per_capita, student_ratio)) +
  geom_point() + 
  scale_x_log10() + 
  scale_y_log10() + 
  geom_text(aes(label = country), hjust = 1, vjust = 1, check_overlap = TRUE)
```

