---
title: "Untitled"
author: "Jaehwan Lim"
date: "January 6, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(stringr)

theme_set(theme_light())

tv_ratings <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/9749b0ef5c5f6690df98fb5bdbbec57e01c35bd5/data/2019/2019-01-08/IMDb_Economist_tv_ratings.csv")

```

```{r}
library(lubridate)

tv_ratings %>% 
  count(date = floor_date(date, "year")) %>% 
  ggplot(aes(x = date, y = n)) +
  geom_line() + 
  labs(x = "Year", 
       y = "# of titles")

tv_ratings %>% 
  group_by(title) %>% 
  mutate(avg_share = mean(share)) %>% 
  ungroup() %>% 
  mutate(title = fct_reorder(title, avg_share)) %>% 
  arrange(desc(avg_share)) %>% 
  distinct(title, .keep_all = T) %>% 
  head(15) %>% 
  ggplot(aes(x = title, y = avg_share)) + 
  geom_col() + 
  coord_flip()
```

### Has TV been getting better or worse over time? 

```{r}

by_year <- tv_ratings %>% 
  group_by(year = 2 * (year(date) %/% 2)) %>% 
  summarize(mean_rating = mean(av_rating), 
            median_rating = median(av_rating),
            mean_season1 = mean(av_rating[seasonNumber == 1]), 
            mean_season = mean(seasonNumber),
            sd_rating = sd(av_rating), 
            observations = n()) 



tv_ratings %>% 
  ggplot(aes(date, av_rating)) +
  geom_point() +
  geom_smooth(method = "loess")

tv_ratings %>% 
  mutate(year = year(date)) %>% 
  ggplot(aes(factor(year), av_rating)) +
  geom_boxplot() 

```

## Do most shows get better or worse over time?
```{r}

```

```{r}
tv_ratings %>%
  filter(seasonNumber <= 7) %>% 
  group_by(seasonNumber) %>% 
  summarize(av_rating = mean(av_rating)) %>% 
  ggplot(aes(x = seasonNumber, y = av_rating)) +
  geom_line()

tv_ratings %>% 
  group_by(title) %>% 
  arrange(date) %>% 
  mutate(season_number = row_number()) %>% 

```

