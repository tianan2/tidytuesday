---
title: "Untitled"
author: "Jaehwan Lim"
date: "January 6, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(stringr)

theme_set(theme_light())

tv_ratings <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/9749b0ef5c5f6690df98fb5bdbbec57e01c35bd5/data/2019/2019-01-08/IMDb_Economist_tv_ratings.csv")

```

```{r}
library(lubridate)

tv_ratings %>% 
  count(date = floor_date(date, "year")) %>% 
  ggplot(aes(x = date, y = n)) +
  geom_line() + 
  labs(x = "Year", 
       y = "# of titles")

tv_ratings %>% 
  group_by(title) %>% 
  mutate(avg_share = mean(share)) %>% 
  ungroup() %>% 
  mutate(title = fct_reorder(title, avg_share)) %>% 
  arrange(desc(avg_share)) %>% 
  distinct(title, .keep_all = T) %>% 
  head(15) %>% 
  ggplot(aes(x = title, y = avg_share)) + 
  geom_col() + 
  coord_flip()

tv_ratings %>% 
  mutate(date = floor_date(date, "year")) %>% 
  group_by(date) %>% 
  mutate(avg_rating = mean(av_rating)) %>% 
  ungroup() %>%
  ggplot(aes(x = date, y = avg_rating)) +
  geom_line() +
  expand_limits(y = 7) 

tv_ratings %>% 
  mutate(date = floor_date(date, "year")) %>% 
  filter(date == "2000-01-01")
  


  



  


```

