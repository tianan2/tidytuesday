---
title: "Untitled"
author: "Jaehwan Lim"
date: "January 28, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)

us_wind <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018/2018-11-06/us_wind.csv")

theme_set(theme_light())

```

```{r}
us_wind %>% 
  filter(p_year != "-9999") %>% 
  count(p_year) %>% 
  ggplot(aes(p_year, n)) + 
  geom_line()

us_wind %>% 
  count(t_state, t_county, sort = T)

us_wind_processed <- us_wind %>% 
  ## another way of excludig particular observations
  filter(!t_state %in% c("AK", "HI", "GU", "PR"))
  
us_wind_processed %>% 
  group_by(p_name) %>% 
  summarize(avg_xlong = mean(xlong, na.rm = T), 
            avg_ylat = mean(ylat, na.rm = T), 
            turbines = n()) %>% 
  ggplot(aes(avg_xlong, avg_ylat, size = turbines)) + 
  geom_point() + 
  borders("state") +
  coord_map() + 
  theme_void()

```

```{r}
us_wind %>% 
  ## another way of excludig particular observations
  filter(!t_state %in% c("AK", "HI", "GU", "PR")) %>% 
  mutate(p_name = fct_lump(p_name, 6)) %>% 
  ggplot(aes(xlong, ylat, color = p_name)) + 
  geom_point() + 
  borders("state") +
  coord_map() + 
  theme_void()

```



